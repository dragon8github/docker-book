æˆ‘ä»¬pulläº†ä¸€ä¸ªçº¯å‡€é•œåƒï¼Œå¦‚æœæƒ³è¦å®‰è£…ä¸€äº›è½¯ä»¶çš„è¯ï¼Œ æ€ä¹ˆåŠï¼Ÿ

1ã€ç¡¬æ¥

åˆ©ç”¨attachè¿›å…¥ï¼Œå„ç§yumï¼Œå„ç§å®‰è£… \(ä½ ä¼šå‘ç°å¥½å¤šæƒé™é—®é¢˜\)

2ã€Dockerfile

ä»Šå¤©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å¦‚ä½•åˆ©ç”¨Dockerfileåˆ›å»ºä¸€ä¸ªé•œåƒ

Dockerfileæ˜¯ç”±ä¸€ç³»åˆ—å‘½ä»¤å’Œå‚æ•°æ„æˆçš„è„šæœ¬ï¼Œè¿™äº›å‘½ä»¤åº”ç”¨äºåŸºç¡€é•œåƒå¹¶æœ€ç»ˆåˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒã€‚

å®˜æ–¹æ–‡æ¡£ï¼š[https://docs.docker.com/engine/reference/builder/\#usage](https://docs.docker.com/engine/reference/builder/#usage)

---

### â° Dockerfile

æ–°å»º Dockerfile

* FROM ï¼š åŸºäºç°æœ‰çš„é•œåƒæ¥åˆ›å»ºï¼ˆä¹Ÿå°±æ˜¯åŸºäº`$ docker images`åˆ—è¡¨ä¸­çš„é•œåƒæ¥åˆ›å»ºï¼‰ï¼›
* RUN ï¼š åœ¨å®¹å™¨ä¸­è¿è¡Œçš„è¯­å¥ï¼›
* EXPOSEï¼šå®¹å™¨å¯¹å¤–æš´éœ²çš„ç«¯å£ï¼Œå¯ä»¥è®¾ç½®å¤šä¸ªã€‚

```js
FROM centos:latest
RUN yum -y install httpd
RUN  systemctl enable httpd.service
EXPOSE 80
```

![](/assets/659659569import.png)

### ğŸ  docker build å‘½ä»¤

ç”¨äºè¯»å– Dockerfile åˆ›å»ºé•œåƒ

> $ docker build -t centos:httpd .

** ï¼ˆæ³¨æ„ï¼Œæœ€åæœ‰ä¸€ä¸ªç‚¹ï¼Œå¾ˆé‡è¦ã€‚ä»£è¡¨å½“å‰æ–‡ä»¶å¤¹ä¸­æ‰¾Dockerfile**ï¼‰

buildå®Œæˆä¹‹åï¼Œé€šè¿‡ `$ docker images` å¯ä»¥çœ‹åˆ°ä¸€ä¸ªæ ‡ç­¾ï¼ˆTAGï¼‰ä¸º httpd çš„ centos æ–°é•œåƒã€‚

> æ ‡ç­¾ä¸ºlatestçš„centosé•œåƒä¸Šä¸€èŠ‚åˆ›å»ºçš„ï¼Œå’Œæœ¬èŠ‚æ²¡æœ‰ä»»ä½•å…³ç³»ã€‚
>
> é¡ºå¸¦ä¸€æï¼Œè¿™ä¸ªTAGåªæ˜¯ä¸€ä¸ªæ ‡æ³¨ã€æ³¨é‡Šã€‚å¹¶ä¸ä¸€å®šè¯´æ˜è¯¥é•œåƒå°±ä¸€å®šæ˜¯æœ€æ–°çš„ã€‚

![](/assets/213123123import.png)

---

### ğŸŒ¼ å¯åŠ¨httpd

docker å¯¹å®¹å™¨çš„æƒé™æœ‰ä¸€å®šçš„é™åˆ¶è§„åˆ™

æ€»è€Œè¨€ä¹‹ï¼Œå¦‚æœæˆ‘ä»¬å°è¯•ä¹‹å‰å­¦åˆ°çš„å¯åŠ¨å®¹å™¨æ–¹å¼å¦‚

> $ docker run  -d -p 8080:80 --name myhttpd centos:httpd

![](/assets/67342import.png)

è¿™æ—¶ä½ ä¼šå‘ç°æ ¹æœ¬å¯åŠ¨ä¸äº†ï¼Œå®ƒå°±æ˜¯ä¸€ç›´å¤„äºåœæ­¢çŠ¶æ€  \(â•¬ï¿£çš¿ï¿£\)å‡¸ã€‚

è¿™æ—¶æˆ‘ä»¬ä»¥äº¤äº’å¼æ–¹å¼è¿›å…¥ã€‚å‘ç°æ˜¯å¯ä»¥è¿›å…¥çš„ï¼ˆéœ€è¦å…ˆåˆ é™¤åˆšåˆšçš„å®¹å™¨ï¼‰

> $ docker run -i -t  -p 8080:80 --name myhttpd centos:httpd

![](/assets/54545544545import.png)æˆ‘ä»¬åœ¨å®¹å™¨ï¼ˆcentos7ï¼‰å†…éƒ¨æŸ¥çœ‹ä¸€ä¸‹httpdçš„çŠ¶æ€ï¼Œå´å‘ç°æ˜¯æ²¡æœ‰æƒé™çš„

![](/assets/56565import.png)

å°±å¦‚æˆ‘ä»¬å¼€å¤´æ‰€è¯´ï¼Œdocker å¯¹å®¹å™¨çš„æƒé™æœ‰ä¸€å®šçš„é™åˆ¶è§„åˆ™ã€‚é‚£ä¹ˆæ€ä¹ˆç»™å®¹å™¨åŠ ç‰¹æƒå‘¢ï¼Ÿ

---

### ğŸ ä½¿ç”¨ --privileged ç»™å®¹å™¨åŠ ç‰¹æƒ

ç»™å®¹å™¨åŠ ç‰¹æƒ,å¦åˆ™äº¤äº’å¼æ–¹å¼è¿›å…¥å®¹å™¨æ— æ³•æ“ä½œä¸€äº›è­¬å¦‚ä¿®æ”¹å†…æ ¸ã€ä¿®æ”¹ç³»ç»Ÿå‚æ•°ã€ç”šè‡³å¯åŠ¨æœåŠ¡ç­‰

> $ docker run --privileged -d -p 8080:80 --name myhttpd centos:httpd /usr/sbin/init

ï¼ˆåœ¨å¯åŠ¨å®¹å™¨æ—¶ï¼Œæ‰§è¡Œå‘½ä»¤ `/usr/sbin/init`ï¼‰

![](/assets/1312331123import.png)æ­¤æ—¶æˆ‘ä»¬å‘ç°å·²ç»å¯åŠ¨æˆåŠŸäº†ã€‚

æˆ‘ä»¬ä»ç„¶ä½¿ç”¨æµè§ˆå™¨è®¿é—®ä¸€ä¸‹ ip + 8080ç«¯å£

![](/assets/6656766import.png)

